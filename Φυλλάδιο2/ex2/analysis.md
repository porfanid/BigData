# Θεωρητική ανάλυση για την τιμή του T

## Ερώτημα: Υπολογισμός της τιμής του T για πιθανότητα επιτυχίας 99%

Σύμφωνα με τη θεωρητική ανάλυση για τον μηχανισμό ανάκτησης 1-αραιού διανύσματος, η πιθανότητα false-positive για μία δοκιμή είναι:

$$P(false-positive) \leq \frac{n}{p-1}$$

όπου:
- n = 10.000 (το μέγεθος του διανύσματος)
- p = 20.011 (ο πρώτος αριθμός που χρησιμοποιείται)

Έτσι, για μία δοκιμή έχουμε:

$$P(false-positive) \leq \frac{10.000}{20.011-1} = \frac{10.000}{20.010} \approx 0,5$$

Όταν χρησιμοποιούμε T ανεξάρτητους τυχαίους αριθμούς r_1, r_2, ..., r_T, η πιθανότητα false-positive μειώνεται εκθετικά:

$$P(false-positive) \leq \left(\frac{n}{p-1}\right)^T$$

Θέλουμε να έχουμε πιθανότητα τουλάχιστον 99% να μην υπάρξει ούτε ένα σφάλμα κατά τη διάρκεια της ροής των 10.000.000 εντολών.

Έστω q η πιθανότητα σφάλματος για μία εντολή. Τότε, η πιθανότητα να μην έχουμε κανένα σφάλμα σε 10.000.000 εντολές είναι:

$$(1-q)^{10.000.000} \geq 0,99$$

Το q είναι η πιθανότητα false-positive, που είναι το πολύ $\left(\frac{n}{p-1}\right)^T$, οπότε πρέπει:

$$(1-\left(\frac{n}{p-1}\right)^T)^{10.000.000} \geq 0,99$$

Για να είναι πιο εύκολος ο υπολογισμός, χρησιμοποιούμε την προσέγγιση $(1-q)^m \approx e^{-m \cdot q}$, η οποία ισχύει για μικρά q και μεγάλα m:

$$e^{-10.000.000 \cdot \left(\frac{n}{p-1}\right)^T} \geq 0,99$$

Παίρνοντας τον λογάριθμο και των δύο μελών:

$$-10.000.000 \cdot \left(\frac{n}{p-1}\right)^T \geq \ln(0,99)$$

$$\left(\frac{n}{p-1}\right)^T \leq \frac{-\ln(0,99)}{10.000.000}$$

$$\left(\frac{10.000}{20.010}\right)^T \leq \frac{0,01005}{10.000.000}$$

$$\left(0,5\right)^T \leq 1,005 \cdot 10^{-9}$$

Παίρνοντας τον λογάριθμο και των δύο μελών ξανά:

$$T \cdot \ln(0,5) \leq \ln(1,005 \cdot 10^{-9})$$

$$T \cdot (-0,693) \leq \ln(1,005) + \ln(10^{-9})$$

$$T \cdot 0,693 \geq -\ln(1,005) - \ln(10^{-9})$$

$$T \cdot 0,693 \geq -0,005 + 9 \cdot \ln(10)$$

$$T \cdot 0,693 \geq -0,005 + 9 \cdot 2,303$$

$$T \cdot 0,693 \geq -0,005 + 20,727$$

$$T \cdot 0,693 \geq 20,722$$

$$T \geq \frac{20,722}{0,693} \approx 29,9$$

Άρα, θεωρητικά χρειαζόμαστε τουλάχιστον **T = 30** για να έχουμε πιθανότητα τουλάχιστον 99% να μην υπάρξει κανένα σφάλμα σε 10.000.000 εντολές.

## Ερώτημα: Εξήγηση για την απαισιοδοξία της θεωρητικής ανάλυσης

Η θεωρητική ανάλυση φαίνεται να είναι υπερβολικά απαισιόδοξη, καθώς στην πράξη, ακόμα και για μικρές τιμές του T (π.χ. T = 2), παρατηρούμε ότι δεν υπάρχουν καθόλου σφάλματα. Η εξήγηση για αυτό το φαινόμενο είναι:

1. **Worst case analysis**: Η θεωρητική ανάλυση εξετάζει το χειρότερο σενάριο, όπου κάθε επεξεργασία μπορεί να οδηγήσει σε false-positive με τη μέγιστη πιθανότητα. Στην πραγματικότητα, οι περισσότερες καταστάσεις του διανύσματος είναι πολύ πιο εύκολο να αναγνωριστούν σωστά.

2. **Υπόθεση ανεξαρτησίας εντολών**: Η θεωρητική ανάλυση υποθέτει ότι κάθε εντολή είναι ανεξάρτητη και μπορεί να οδηγήσει σε σφάλμα. Ωστόσο, οι εντολές που παράγονται από τη γεννήτρια ακολουθούν συγκεκριμένα μοτίβα. Ειδικότερα, η γεννήτρια έχει σχεδιαστεί έτσι ώστε το διάνυσμα να είναι 1-αραιό αρκετά συχνά, καθώς περιέχει φάσεις επιστροφής στο 0 και φάσεις όπου μόνο η ειδική συντεταγμένη s είναι μη-μηδενική.

3. **Συσχέτιση των συντεταγμένων**: Στη γεννήτρια που υλοποιήσαμε, υπάρχει συσχέτιση μεταξύ των συντεταγμένων του διανύσματος. Για παράδειγμα, στη φάση Β, όλες οι συντεταγμένες μηδενίζονται σταδιακά, ενώ στη φάση Α1 μηδενίζονται τυχαίες συντεταγμένες με πιθανότητα 1/3. Αυτό οδηγεί σε διαφορετική συμπεριφορά από τη χειρότερη περίπτωση που αναλύει η θεωρία.

4. **Πραγματική κατανομή των false-positives**: Το άνω φράγμα $\frac{n}{p-1}$ είναι αρκετά χαλαρό. Στην πραγματικότητα, η πιθανότητα false-positive είναι πολύ μικρότερη, ειδικά για τις κατανομές εισόδου που παράγει η γεννήτρια μας.

5. **Δομή της γεννήτριας**: Η γεννήτρια είναι σχεδιασμένη έτσι ώστε το διάνυσμα να είναι "σχεδόν τυχαίο", αλλά "σχετικά συχνά" να έχει ακριβώς μία μη-μηδενική συντεταγμένη. Αυτό σημαίνει ότι το διάνυσμα περνάει από καταστάσεις όπου είναι εύκολο να αναγνωριστεί αν είναι 1-αραιό ή όχι.

Συνοψίζοντας, η θεωρητική ανάλυση μας δίνει ένα άνω φράγμα για τη χειρότερη περίπτωση, αλλά στην πράξη, η συγκεκριμένη κατανομή εισόδου που δημιουργούμε έχει πολύ καλύτερη συμπεριφορά, με αποτέλεσμα να απαιτούνται πολύ μικρότερες τιμές του T για να εξασφαλιστεί η απουσία σφαλμάτων.